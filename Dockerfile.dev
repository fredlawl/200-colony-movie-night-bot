FROM golang:1.16.3-alpine3.13

ENV CGO_ENABLED=1

RUN apk update
RUN apk add bash shadow sqlite

# Packages needed for setting up VS Code SQL extensions
RUN apk add g++ make python3 nodejs npm
RUN ln -sf python3 /usr/bin/python

RUN groupadd -g 1000 docker
RUN useradd -u 1000 -ms /bin/bash -g docker golang

COPY --chown=golang:docker . /home/golang
WORKDIR /home/golang

USER golang

VOLUME /home/golang

RUN go get -v golang.org/x/tools/gopls
RUN go get -v github.com/go-delve/delve/cmd/dlv
RUN go get -v github.com/ramya-rao-a/go-outline
RUN go get -v golang.org/x/lint/golint
RUN go get -v golang.org/x/tools/refactor/rename
RUN go get -v github.com/godoctor/godoctor
RUN go get -v honnef.co/go/tools/cmd/staticcheck

RUN cd cli && go mod tidy
RUN cd bot && go mod tidy